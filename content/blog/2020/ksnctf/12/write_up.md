---
title: ksnctf Q.12
date: "2020-09-01"
draft: false
category: "CTF"
tags:
    - "ksnctf"
cover: "../media/"
---

# kusanoCTF Q.12 Hypertext Preprocessor

問題には url が掲載されている。

url を開くと、時間が表示されたサイトが開かれる。

なんかホラーサイトみたいな見た目で、放置したらドッキリ系のアニメーションが起こりそうな雰囲気があるが、とりあえずディベロッパーツールを開く。

特に js とかはなさそう。

ここで、url の末尾のファイル拡張子が php であることに気づく。

そういえば、つい最近 PHP でもっとも悪用された脆弱性というものを見たなと思い出した。

非常に簡単に任意コマンドが実行できてしまう脆弱性だ。

詳細については下の動画がある

https://www.youtube.com/watch?v=XiIPXQX8RRU

案の定、パラメータに -s を入れたらソースコードが表示された。

ソースコードには

「 Flag is in this directory.」とコメントが。

あとは、ls コマンドで flag っぽいファイルを探して、 cat コマンドで表示して終了だ。

# 感想

これはすごい脆弱性だ。

正確には、任意の php プログラムが実行できるわけだが、なんでもできそう。（権限によるだろうけど。）

古い php サイトとかだったら簡単にできてしまいそう
